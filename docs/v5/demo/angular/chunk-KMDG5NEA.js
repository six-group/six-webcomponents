import{a as u}from"./chunk-W2HL4QJA.js";import{a as b}from"./chunk-5PXSTT2V.js";import{a as p}from"./chunk-HDKLD45I.js";import{a as v}from"./chunk-7R52OV2X.js";import{c as f,d as l,f as m,g as a}from"./chunk-CUSM5KU5.js";function w(t){return t.tabIndex>-1}function I(t){if(w(t))return t;if(t.shadowRoot!=null){let e=[...t.shadowRoot.children].find(i=>w(i));if(e!=null)return e}if(t.children!=null)return[...t.children].map(e=>I(e)).at(0)}var E=":host{position:relative;box-sizing:border-box}:host *,:host *:before,:host *:after{box-sizing:border-box}.sr-only{clip:rect(0 0 0 0);clip-path:inset(50%);height:1px;overflow:hidden;position:absolute;white-space:nowrap;width:1px}:host{display:inline-block}.dropdown{position:relative}.dropdown__trigger{display:block}.dropdown__positioner{position:absolute;z-index:var(--six-z-index-dropdown)}.dropdown__positioner__filtered{width:100%}.dropdown__panel{font-family:var(--six-font-sans);font-size:var(--six-font-size-small);font-weight:var(--six-font-weight-normal);color:var(--color);background-color:var(--six-panel-background-color);border-radius:var(--six-border-radius-medium);border:1px solid var(--six-color-web-rock-300);box-shadow:var(--six-shadow-small);opacity:0;pointer-events:none;transform:scale(0.9);transition:var(--six-transition-fast) opacity, var(--six-transition-fast) transform;max-width:90vw}.dropdown__panel__scroll{max-height:18.75rem;overflow-y:auto;overflow-x:hidden;overscroll-behavior:none}.dropdown__panel__scroll--virtual{overflow-y:hidden;overflow-x:hidden}.filter-hidden{display:none}.dropdown__positioner[data-popper-placement^=top] .dropdown__panel{transform-origin:bottom}.dropdown__positioner[data-popper-placement^=bottom] .dropdown__panel{transform-origin:top}.dropdown__positioner[data-popper-placement^=left] .dropdown__panel{transform-origin:right}.dropdown__positioner[data-popper-placement^=right] .dropdown__panel{transform-origin:left}.dropdown__positioner.popover-visible .dropdown__panel{opacity:1;transform:none;pointer-events:all}.filter{border-bottom:1px solid var(--six-color-web-rock-300)}.filter__icon{color:var(--six-color-web-rock-600)}",T=0,A=class{constructor(t){f(this,t),this.sixShow=a(this,"six-dropdown-show"),this.sixAfterShow=a(this,"six-dropdown-after-show"),this.sixHide=a(this,"six-dropdown-hide"),this.sixAfterHide=a(this,"six-dropdown-after-hide"),this.sixAutoFilter=a(this,"six-dropdown-auto-filter-fired"),this.sixAsyncFilterFired=a(this,"six-async-filter-fired"),this.sixScroll=a(this,"six-dropdown-scroll"),this.componentId=`dropdown-${++T}`,this.isVisible=!1,this.resizeObserver=new ResizeObserver(u(()=>this.updatePanelPosition(),100)),this.open=!1,this.placement="bottom-start",this.closeOnSelect=!0,this.distance=4,this.skidding=0,this.hoist=!1,this.filter=!1,this.asyncFilter=!1,this.filterPlaceholder="Filter...",this.autofocusFilter=!0,this.filterDebounce=0,this.disableHideOnEnterAndSpace=!1,this.options=[],this.virtualScroll=!1,this.matchTriggerWidth=!1,this.eventListeners=new p,this.renderedOptions=[],this.getMenuItems=()=>{var e,i,s,o;if(this.options.length>0)return{sixMenuItems:this.renderedOptions.map(c=>l("six-menu-item",{value:c.value},c.label)),selectionContainerItems:[]};if(this.panel==null)return{sixMenuItems:[],selectionContainerItems:[]};let r=(e=this.panelSlot)===null||e===void 0?void 0:e.assignedElements({flatten:!0}).filter(C).at(0),n=(i=this.panelSlot)===null||i===void 0?void 0:i.assignedElements({flatten:!0}).filter(g).at(0),h=r?.querySelectorAll("six-menu-item")||[],d=((s=n?.querySelector("slot"))===null||s===void 0?void 0:s.assignedElements().filter(c=>x(c)))||[];return d.length===0&&(d=Array.from(((o=n?.shadowRoot)===null||o===void 0?void 0:o.querySelectorAll("six-menu-item"))||[])),h.length>0||d.length>0?{sixMenuItems:d,selectionContainerItems:[...h]}:{sixMenuItems:n?Array.from(n.querySelectorAll("six-menu-item")):[],selectionContainerItems:[]}},this.handleDocumentKeyDown=e=>{var i;let s=e;if(s.key==="Escape"){this.hide(),this.focusOnTrigger();return}if(this.filterInputElement===((i=this.host.shadowRoot)===null||i===void 0?void 0:i.activeElement)&&s.key==="ArrowDown"){let{sixMenuItems:o,selectionContainerItems:r}=this.getMenuItems(),n=[...r,...o].find(h=>h.style.display!=="none");n?.setFocus()}if(s.key==="Tab"){if(this.open&&document.activeElement!=null&&x(document.activeElement)){s.preventDefault(),this.hide(),this.focusOnTrigger();return}setTimeout(()=>{var o,r;let n=this.container.getRootNode()instanceof ShadowRoot?(r=(o=document.activeElement)===null||o===void 0?void 0:o.shadowRoot)===null||r===void 0?void 0:r.activeElement:document.activeElement;if(n?.closest(this.container.tagName.toLowerCase())!==this.container){this.hide();return}})}},this.handleDocumentMouseDown=e=>{if(!e.composedPath().includes(this.container)){this.hide();return}},this.handlePanelSelect=e=>{let i=e.target;this.closeOnSelect&&g(i)&&(this.hide(),this.focusOnTrigger())},this.handleTriggerClick=()=>{this.open?this.hide():this.show()},this.handleTriggerKeyDown=e=>{if(e.key==="Escape"){this.focusOnTrigger(),this.hide();return}if(!this.disableHideOnEnterAndSpace&&[" ","Enter"].includes(e.key)){e.preventDefault(),this.open?this.hide():this.show();return}let i=this.getMenu();if(["ArrowDown","ArrowUp"].includes(e.key)){if(e.preventDefault(),this.open||this.show(),i==null)return;let o=[...i.querySelectorAll("six-menu-item")],r=o.at(0),n=o.at(o.length-1);if(e.key==="ArrowDown"&&r!=null){r.setFocus();return}if(e.key==="ArrowUp"&&n!=null){n.setFocus();return}}let s=["Tab","Shift","Meta","Ctrl","Alt"];if(this.open&&i!=null&&!s.includes(e.key)){i.typeToSelect(e.key);return}},this.handleTriggerKeyUp=e=>{e.key===" "&&e.preventDefault()},this.handleTriggerSlotChange=()=>{this.updateAccessibleTrigger()},this.handleDropdownScroll=()=>{this.scrollPanel!=null&&this.sixScroll.emit({scrollHeight:this.scrollPanel.scrollHeight,scrollTop:this.scrollPanel.scrollTop,scrollbarHeight:this.scrollPanel.offsetHeight*(this.scrollPanel.offsetHeight/this.scrollPanel.scrollHeight),scrollRatio:this.scrollPanel.scrollTop/(this.scrollPanel.scrollHeight-this.scrollPanel.clientHeight)})}}get filterEnabled(){return this.filter||this.asyncFilter}get container(){return this.containingElement||this.host}handleOpenChange(){this.open?this.show():this.hide(),this.updateAccessibleTrigger()}handlePopoverOptionsChange(){this.popoverHelper!=null&&this.popoverHelper.setOptions({strategy:this.hoist?"fixed":"absolute",placement:this.placement,distance:this.distance,skidding:this.skidding})}handleOptionsChange(){this.validateOptions()}validateOptions(){Array.isArray(this.options)||(this.options=[]),this.virtualScroll&&this.options.length===0&&console.error("Options must be defined when using virtual scrolling"),this.renderedOptions=[...this.options]}componentWillLoad(){this.validateOptions(),this.asyncFilter&&(this.filterDebounce=300)}componentDidLoad(){this.init(),this.open&&this.show()}connectedCallback(){this.init()}init(){this.initPopover();let t=this.filterInputElement;t!=null&&this.eventListeners.add(t,"six-input-input",u(()=>{var e;let i=(e=t.value)!==null&&e!==void 0?e:"";this.filter&&this.applyFilter(i),this.emitFilterEvents(i)},this.filterDebounce))}applyFilter(t){var e;let i=((e=t.toLowerCase())===null||e===void 0?void 0:e.trim())||"";if(this.options.length>0)this.renderedOptions=this.options.filter(s=>{var o,r,n,h;return s.label&&((r=(o=String(s.label))===null||o===void 0?void 0:o.toLowerCase())===null||r===void 0?void 0:r.includes(i))||s.value&&((h=(n=String(s.value))===null||n===void 0?void 0:n.toLowerCase())===null||h===void 0?void 0:h.includes(i))});else{let{selectionContainerItems:s,sixMenuItems:o}=this.getMenuItems(),r=s.map(n=>n.value);s.forEach(async n=>{n.style.display=await y(n,i)?"unset":"none"}),o.forEach(async n=>{n.style.display=await y(n,i)&&!r.includes(n.value)?"unset":"none"})}}resetFilter(){if(this.filterInputElement!=null&&(this.filterInputElement.value="",this.emitFilterEvents("")),this.options.length>0)this.renderedOptions=[...this.options];else{let{selectionContainerItems:t,sixMenuItems:e}=this.getMenuItems();[...t,...e].forEach(i=>i.style.display="unset")}}emitFilterEvents(t){this.filter?this.sixAutoFilter.emit({filterValue:t}):this.asyncFilter&&this.sixAsyncFilterFired.emit({filterValue:t})}initPopover(){this.trigger==null||this.positioner==null||(this.popoverHelper=new b(this.trigger,this.positioner,{strategy:this.hoist?"fixed":"absolute",placement:this.placement,distance:this.distance,skidding:this.skidding,transitionElement:this.panel,onAfterHide:()=>{this.filterEnabled&&this.resetFilter(),this.sixAfterHide.emit()},onAfterShow:async()=>{this.sixAfterShow.emit()},onTransitionEnd:()=>{!this.open&&this.scrollPanel!=null&&(this.scrollPanel.scrollTop=0)}}))}disconnectedCallback(){var t;this.resizeObserver.disconnect(),this.eventListeners.removeAll(),this.hide(),(t=this.popoverHelper)===null||t===void 0||t.destroy(),this.popoverHelper=void 0}async show(){if(this.isVisible||this.popoverHelper==null||this.panel==null)return;if(this.sixShow.emit().defaultPrevented){this.open=!1;return}this.eventListeners.add(this.panel,"six-menu-item-selected",this.handlePanelSelect),this.eventListeners.add(document,"keydown",this.handleDocumentKeyDown),this.eventListeners.add(document,"mousedown",this.handleDocumentMouseDown),this.isVisible=!0,this.open=!0,this.trigger!=null&&this.resizeObserver.observe(this.trigger),this.updatePanelPosition(),this.popoverHelper.show(),this.filterEnabled&&this.autofocusFilter&&requestAnimationFrame(()=>{var e;(e=this.filterInputElement)===null||e===void 0||e.setFocus()})}updatePanelPosition(){if(this.open){if(this.matchTriggerWidth&&this.trigger!=null&&this.panel!=null){let t=this.trigger.getBoundingClientRect().width;this.panel.style.minWidth=`${t}px`}this.popoverHelper!=null&&this.popoverHelper.reposition()}}async hide(){if(this.resizeObserver.disconnect(),!this.isVisible||this.panel==null||this.popoverHelper==null)return;if(this.sixHide.emit().defaultPrevented){this.open=!0;return}this.eventListeners.remove(this.panel,"six-menu-item-selected",this.handlePanelSelect),this.eventListeners.remove(document,"keydown",this.handleDocumentKeyDown),this.eventListeners.remove(document,"mousedown",this.handleDocumentMouseDown),this.isVisible=!1,this.open=!1,this.popoverHelper.hide()}focusOnTrigger(){var t;if(this.trigger==null)return;let e=(t=this.triggerSlot)===null||t===void 0?void 0:t.assignedElements({flatten:!0}).at(0);e!=null&&(typeof e.setFocus=="function"?e.setFocus():typeof e.focus=="function"&&e.focus())}getMenu(){var t;return(t=this.panelSlot)===null||t===void 0?void 0:t.assignedElements({flatten:!0}).filter(g).at(0)}updateAccessibleTrigger(){var t;if(this.trigger==null)return;let i=(((t=this.triggerSlot)===null||t===void 0?void 0:t.assignedElements({flatten:!0}))||[]).map(I).at(0);i!=null&&(i.setAttribute("aria-haspopup","true"),i.setAttribute("aria-expanded",this.open?"true":"false"))}render(){return l("div",{key:"46305375a199fb17ae66ca3b6678634844d0b8a2",part:"base",id:this.componentId,class:{dropdown:!0,"dropdown--open":this.open}},l("span",{key:"2a53d2cf2b75607614f39675cabfe1362b297e70",part:"trigger",class:"dropdown__trigger",ref:t=>this.trigger=t,onClick:this.handleTriggerClick,onKeyDown:this.handleTriggerKeyDown,onKeyUp:this.handleTriggerKeyUp},l("slot",{key:"d8abcd455c768fded48df4c18b8191e365db4ab1",name:"trigger",ref:t=>this.triggerSlot=t,onSlotchange:this.handleTriggerSlotChange})),l("div",{key:"fd0e0352800daebdc9843442901cad9769d3199a",ref:t=>this.positioner=t,class:{dropdown__positioner:!0,dropdown__positioner__filtered:(this.filter||this.asyncFilter)&&!this.hoist}},l("div",{key:"2d72ca0ba1a5cbb480727e325048f7a171fb7af8",ref:t=>this.panel=t,part:"panel",class:"dropdown__panel",role:"menu","aria-hidden":this.open?"false":"true","aria-labelledby":this.componentId},this.filterEnabled&&l("six-input",{key:"a22263fb924be51081598579391774c82a09852f",class:{filter:!0,"filter-hidden":!this.open},"dropdown-search":!0,"aria-hidden":this.open?"false":"true",ref:t=>this.filterInputElement=t,placeholder:this.filterPlaceholder},l("six-icon",{key:"7a8fc9e25e7e209b5b0aa05af5dcefca87e3b9d5",class:"filter__icon",slot:"suffix",size:"small"},"search")),l("div",{key:"bedcab39d656be8ce064852ef9344b4fbbf60b17",class:{dropdown__panel__scroll:!0,"dropdown__panel__scroll--virtual":this.virtualScroll},onScroll:this.handleDropdownScroll,ref:t=>this.scrollPanel=t},l("slot",{key:"21acba56de1fba98afdfda60e8b09816a70ac057",ref:t=>this.panelSlot=t}),this.options.length>0&&l("six-menu",{key:"d7d429d062bf111ffdaf667ada0efe640136871a",part:"menu",items:this.renderedOptions,virtualScroll:this.virtualScroll})),l("slot",{key:"e23be3aa659ed7fa4a513d82c982733b58a6e9db",name:"dropdown-footer"}))))}get host(){return m(this)}static get watchers(){return{open:["handleOpenChange"],distance:["handlePopoverOptionsChange"],hoist:["handlePopoverOptionsChange"],placement:["handlePopoverOptionsChange"],skidding:["handlePopoverOptionsChange"],options:["handleOptionsChange"],virtualScroll:["handleOptionsChange"]}}};function g(t){return t?.tagName.toLowerCase()==="six-menu"}function x(t){return t?.tagName.toLowerCase()==="six-menu-item"}function C(t){var e;return((e=t?.getAttribute("class"))===null||e===void 0?void 0:e.includes("selection-container"))||!1}async function y(t,e){return t.value.toLowerCase().includes(e)||(await t.getTextLabel()).toLowerCase().includes(e)}A.style=E;var M=":host{position:relative;box-sizing:border-box}:host *,:host *:before,:host *:after{box-sizing:border-box}.sr-only{clip:rect(0 0 0 0);clip-path:inset(50%);height:1px;overflow:hidden;position:absolute;white-space:nowrap;width:1px}:host{display:block}.menu{padding:var(--six-spacing-xx-small) 0;border:none;box-shadow:var(--six-shadow-small);overflow-y:auto;overflow-x:hidden}.menu:focus{outline:none}.no-shadow{box-shadow:none}",S=t=>{var e,i,s;return(s=(i=(e=t?.shadowRoot)===null||e===void 0?void 0:e.querySelector(".menu-item"))===null||i===void 0?void 0:i.classList)===null||s===void 0?void 0:s.contains("menu-item--focused")},D=t=>t?.tagName.toLowerCase()==="six-menu-item",_=({value:t,label:e})=>l("six-menu-item",{key:t,value:t},e),O=5,F=48,H=64,U=(()=>{let t=class{constructor(e){f(this,e),this.sixMenuItemSelected=a(this,"six-menu-item-selected"),this.eventListeners=new p,this.typeToSelectString="",this.removeBoxShadow=!1,this.items=null,this.virtualScroll=!1,this.itemSize=10,this.scrollingDebounce=15,this.disableKeyboardHandling=!1,this.scrollingIndex=0,this.sixMenuItemHeight=this.virtualScroll?F:H,this.handleScrolling=()=>{this.menuWrapper!=null&&(this.scrollingIndex=Math.floor(this.menuWrapper.scrollTop/this.sixMenuItemHeight))}}connectedCallback(){this.handleClick=this.handleClick.bind(this),this.handleKeyDown=this.handleKeyDown.bind(this)}componentWillLoad(){this.items}componentDidLoad(){this.setupForVirtualScrollingAfterRendering()}disconnectedCallback(){this.eventListeners.removeAll()}async typeToSelect(e){var i;clearTimeout(this.typeToSelectTimeout),this.typeToSelectTimeout=setTimeout(()=>this.typeToSelectString="",750),this.typeToSelectString+=e.toLowerCase();let s=this.getItems();for(let o of s){let r=(i=o.shadowRoot)===null||i===void 0?void 0:i.querySelector("slot:not([name])");if(v(r).toLowerCase().trim().substring(0,this.typeToSelectString.length)===this.typeToSelectString){o.setFocus();break}}}getItemsShown(){var e;let i=this.virtualScroll?O:0;return this.items&&this.items.length===1?0:(e=this.itemsShown)!==null&&e!==void 0?e:i}setupForVirtualScrollingAfterRendering(){var e,i;if(!this.virtualScroll||this.menuWrapper==null)return;this.eventListeners.add(this.menuWrapper,"scroll",u(this.handleScrolling,this.scrollingDebounce));let s=(i=(e=this.menu)===null||e===void 0?void 0:e.querySelector("six-menu-item"))===null||i===void 0?void 0:i.clientHeight;s!=null&&s>0&&(this.sixMenuItemHeight=s)}getItems(){if(this.menu==null)return[];if(this.items!=null)return this.items.map(_);let e=this.menu.querySelector("slot");return e==null?[]:[...e.assignedElements({flatten:!0})].filter(i=>D(i)&&!i.disabled)}getActiveItemIndex(){let e=this.getItems(),i=this.getActiveItem();if(i!=null){let o=e.indexOf(i);if(o>-1)return o}return this.extractItemsFromDOM().findIndex(S)}getActiveItem(){var e;let i=this.getItems().find(s=>s===document.activeElement);return i??((e=this.extractItemsFromDOM())===null||e===void 0?void 0:e.find(S))}extractItemsFromDOM(){var e,i;return Array.from((i=(e=this.host.shadowRoot)===null||e===void 0?void 0:e.querySelectorAll("six-menu-item"))!==null&&i!==void 0?i:[])}setActiveItem(e){e?.setFocus()}handleClick(e){let s=e.target.closest("six-menu-item");s&&!s.disabled&&this.sixMenuItemSelected.emit({name:s.value,item:s})}handleKeyDown(e){if(!this.disableKeyboardHandling){if(e.key==="Enter"){let i=this.getActiveItem();e.preventDefault(),i!=null&&this.sixMenuItemSelected.emit({name:i.value,item:i})}if(e.key===" "&&e.preventDefault(),["ArrowDown","ArrowUp","Home","End"].includes(e.key)){let i=this.items===null?this.getItems():this.extractItemsFromDOM(),s=this.getActiveItemIndex();if(i.length>0){e.preventDefault(),e.key==="ArrowDown"?s++:e.key==="ArrowUp"?s--:e.key==="Home"?s=0:e.key==="End"&&(s=i.length-1),s<0&&(s=0),s>i.length-1&&(s=i.length-1),this.setActiveItem(i[s]);return}}this.typeToSelect(e.key)}}getMenuWrapperStyle(){var e;let i={};return this.getItemsShown()>0?i.height=`${((e=this.getItemsShown())!==null&&e!==void 0?e:0)*this.sixMenuItemHeight}px`:this.items&&this.items.length===1&&(i.height="auto"),Object.assign({},i)}getMenuContainerStyle(){let e={};return this.virtualScroll&&(e.transform=`translateY(${this.sixMenuItemHeight*this.scrollingIndex}px)`),Object.assign({},e)}getScrollbarGhostStyle(){let e={};return this.virtualScroll&&this.items!==null&&this.items.length>1&&(e.height=`${this.items.length*this.sixMenuItemHeight-this.itemSize*this.sixMenuItemHeight}px`),Object.assign({},e)}renderItems(){if(!(this.items===void 0||this.items===null))return this.virtualScroll?this.items.slice(this.scrollingIndex,Math.min(this.items.length,this.itemSize+this.scrollingIndex)).map(({value:e,label:i})=>l("six-menu-item",{checkType:"check",key:e,value:e},i)):this.items.map(_)}render(){return l("div",{key:"5b49fa6852d9d86c36e77533e06950ca5c320675",ref:e=>this.menuWrapper=e,style:this.getMenuWrapperStyle(),part:"wrapper",class:{menu:!0,"no-shadow":this.removeBoxShadow}},l("div",{key:"b471da4ddcd06d56f21b020491c41c53766757a6",ref:e=>this.menu=e,part:"base",role:"menu",onClick:this.handleClick,onKeyDown:this.handleKeyDown,tabIndex:0,style:this.getMenuContainerStyle()},l("slot",{key:"e04e2751c6afd78db344211ca1e6db55b6b6d829"}),this.renderItems()),this.virtualScroll&&l("div",{key:"63dcb8d734ae480e7a4a8dcd50f0dc4131f8cb09",style:this.getScrollbarGhostStyle()}))}get host(){return m(this)}};return t.style=M,t})();export{A as six_dropdown,U as six_menu};
